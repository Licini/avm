<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Detail</title>
    <link rel="stylesheet" href="avm.css">
    <style>

        body{

            /*overflow: hidden;*/
            padding: 0;
            margin: 0;

        }

    </style>
</head>
<body>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<div class="load"> <img src="pics/load/0.gif" class="loadImg"></div>
<div id="menu" class="black">

    <div class="menu black" id="work">Work <div class="selectLine blackLine"></div></div>  /
    <div class="menu black" id="about">About <div class="selectLine blackLine"></div></div>  /
    <div class="menu black" id="contact">Contact <div class="selectLine blackLine"></div></div>  /


</div>

<div class="detailContainer">

    <div class="detailImageContainer">

        <img class="detailImage" src="pics/detail/0/0.jpg">
        <img src="pics/Cube.png" class="button left">
        <img src="pics/Cube.png" class="button right">

    </div>


    <div class="detailTextContainer">

        <div class="detailTitle">About</div>
        <div id="text1" class="detailText"></div>
        <div class="detailTitle">Execution</div>
        <div id="text2" class="detailText"></div>
        <div class="detailTitle">Programs Used</div>
        <div id="text3" class="detailText"></div>

    </div>

</div>


<script>

    var getUrlParameter = function getUrlParameter(sParam) {
        var sPageURL = decodeURIComponent(window.location.search.substring(1)),
            sURLVariables = sPageURL.split('&'),
            sParameterName,
            i;

        for (i = 0; i < sURLVariables.length; i++) {
            sParameterName = sURLVariables[i].split('=');

            if (sParameterName[0] === sParam) {
                return sParameterName[1] === undefined ? true : sParameterName[1];
            }
        }
    };


    var projectNum = getUrlParameter('projectNum') || 0;
    var detailNum = getUrlParameter('detailNum') || 0;

    $(".detailImage").attr("src","pics/detail/"+projectNum+"/"+detailNum+".jpg");

    $.get('pics/detail/detail.json',function (data) {

        console.log(data);

        $('#text1').text(data.detail[detailNum]['About']);



        var text = '';

        data.detail[detailNum]['Execution'].forEach(function (t) {

            text+= t + "<br>"

        });

        $('#text2').html(text);


        text = '';
        data.detail[detailNum]['Programs Used'].forEach(function (t) {

            text+= t + "<br>"

        });

        $('#text3').html(text);


    });

    var rotate;

    $('.left').fadeOut();

    $('.left').mouseenter(function () {

        rotateAnime($(this),-90,0,200)

    });

    $('.left').mouseleave(function () {

        rotateAnime($(this),0,-90,200)

    });

    $('.right').mouseenter(function () {

        rotateAnime($(this),90,0,200)

    });

    $('.right').mouseleave(function () {

        rotateAnime($(this),0,90,200)

    });

    $('.left').click(function () {

        if(lock) {

            console.log('locked');
            return;

        }

        lock = true;

        var detailImage = $(".detailImage");
        detailImage.animate({'opacity':0},500,function () {

            detailImage.attr("src","pics/detail/"+projectNum+"/"+(--detailNum)+".jpg");
            if(detailNum<=0) $('.left').fadeOut();
            lock = false;

        });


        detailImage.one("load", function() {
            detailImage.animate({'opacity':1},500,function () {



            });
        });



    });

    var lock = false;


    $('.right').click(function () {

        if(lock) {

            console.log('locked');
            return;

        }

        lock = true;

        var detailImage = $(".detailImage");
        detailImage.animate({'opacity':0},500,function () {

            detailImage.attr("src","pics/detail/"+projectNum+"/"+(++detailNum)+".jpg");
            if(detailNum>0) $('.left').fadeIn();
            lock = false;

        });


        detailImage.one("load", function() {
            detailImage.animate({'opacity':1},500,function () {



            });
        });



    });

    function rotateAnime(obj,target,current,time) {

        if(rotate)  clearInterval(rotate);
        rotate = setInterval(function () {

            obj.css({'transform' : 'rotate('+(current+= (target-current)/(time/20) )+'deg)'});

            if(Math.abs(current - target)<=0.01) clearInterval(rotate);

        },20)

    }




</script>
<script src="menu.js"></script>
</body>
</html>